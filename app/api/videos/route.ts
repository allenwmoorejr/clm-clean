import { NextResponse } from 'next/server';import { fetchChannelRss } from '@/lib/youtube';export async function GET(req:Request){const {searchParams}=new URL(req.url);const limit=Number(searchParams.get('limit')||60);const id=process.env.CHANNEL_ID;if(!id)return NextResponse.json({error:'CHANNEL_ID not set'},{status:500});try{const rss=await fetchChannelRss(id);const entries=(rss.feed?.entry||[]) as any[];const items=entries.slice(0,limit).map((e:any)=>({id:(e['yt:videoId']||e['yt:videoid']),title:e.title,published:e.published,thumbnail:e['media:group']?.['media:thumbnail']?.url||`https://i.ytimg.com/vi/${e['yt:videoId']}/hqdefault.jpg`}));return NextResponse.json({items})}catch(err:any){return NextResponse.json({error:err.message},{status:500})}}